import e from"axios";function t(){return t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},t.apply(this,arguments)}const s=(e,t,s,a,i)=>new Promise((n,r)=>{const o={};if(e||(o.message=`Missing ${a||"Params"}`,o.status=400,r(o)),"search"===i){const{searchQuery:t}=e;t||(o.message="Missing searchQuery",o.status=400,r(o))}if("retrieve"===i){const{id:t}=e;t||(o.message="Missing id",o.status=400,r(o))}if("autocomplete"===i){const{field:t}=e,s=["company","country","industry","location","major","region","role","school","sub_role","skill","title"];t?-1===s.indexOf(t)&&(o.message=`field should be one of: ${s}`,o.status=400,r(o)):(o.message="Missing field",o.status=400,r(o))}if("jobTitle"===i){const{jobTitle:t}=e;t||(o.message="Missing jobTitle",o.status=400,r(o))}if("skill"===i){const{skill:t}=e;t||(o.message="Missing skill",o.status=400,r(o))}t||(o.message="Missing API Base Path",o.status=400,r(o)),s&&64===s.length||(o.message="Invalid API Key",o.status=401,r(o)),n()}),a=e=>{const t={400:"Request contained either missing or invalid parameters",401:"Request contained a missing or invalid key",402:"Payment Required, You have hit your account maximum (all matches used)",404:"No records were found matching your request",405:"Request method is not allowed on the requested resource",429:"An error occurred due to requests hitting the API too quick",500:"The server encountered an unexpected condition which prevented it from fulfilling the request"};if(e.response){const{status:s}=e.response,a=s>=500&&s<600?500:s;return{status:a,message:t[a]}}return{status:500,message:t[500]}},i=e=>{const s={rateLimitRemaining:e.headers["x-ratelimit-remaining"]?JSON.parse(e.headers["x-ratelimit-remaining"].replace(/'/g,'"')):void 0,rateLimitReset:e.headers["x-ratelimit-reset"]||void 0,rateLimitLimit:e.headers["x-ratelimit-limit"]?JSON.parse(e.headers["x-ratelimit-limit"].replace(/'/g,'"')):void 0,totalLimitOveragesRemaining:e.headers["x-totallimit-overages-remaining"]?Number(e.headers["x-totallimit-overages-remaining"]):void 0,totalLimitPurchasedRemaining:e.headers["x-totallimit-purchased-remaining"]?Number(e.headers["x-totallimit-purchased-remaining"]):void 0,totalLimitRemaining:e.headers["x-totallimit-remaining"]?Number(e.headers["x-totallimit-remaining"]):void 0,callCreditsType:e.headers["x-call-credits-type"]||void 0,callCreditsSpent:e.headers["x-call-credits-spent"]?Number(e.headers["x-call-credits-spent"]):void 0,lifetimeUsed:e.headers["x-lifetime-used"]?Number(e.headers["x-lifetime-used"]):void 0};return Array.isArray(e.data)?{items:e.data,rateLimit:s}:t({},e.data,{rateLimit:s})};var n=(n,r,o,h)=>new Promise((l,c)=>{s(o,n,r,null,"cleaner").then(()=>{e.get(`${n}/${h}/clean`,{params:t({api_key:r},o),headers:{"Accept-Encoding":"gzip","User-Agent":"PDL-JS-SDK"}}).then(e=>{var t;200===(null==e||null==(t=e.data)?void 0:t.status)&&l(i(e))}).catch(e=>{c(a(e))})}).catch(e=>{c(e)})}),r=(n,r,o,h,l)=>new Promise((c,d)=>{s(h,n,o,null,"enrichment").then(()=>{const s=h.sandbox&&"person"===l?`${r}/${l}/enrich`:`${n}/${l}/enrich`,p=h;delete p.sandbox,Object.entries(p).forEach(([e,t])=>{"object"==typeof t&&(p[e]=JSON.stringify(t))}),e.get(s,{params:t({api_key:o},p),headers:{"Accept-Encoding":"gzip","User-Agent":"PDL-JS-SDK"}}).then(e=>{var t;200===(null==e||null==(t=e.data)?void 0:t.status)&&c(i(e))}).catch(e=>{d(a(e))})}).catch(e=>{d(e)})}),o=(t,n,r,o,h,l)=>new Promise((c,d)=>{s(h,t,r,null,"search").then(()=>{const{dataset:s,searchQuery:p,size:m,scroll_token:u,titlecase:g,pretty:y,sandbox:b}=h;e.post(b&&"person"===l?`${n}/person/search`:`${t}/${l}/search`,{titlecase:g||!1,dataset:s||"all",scroll_token:u||null,size:m||10,["sql"===o?"sql":"query"]:p,pretty:y||!1},{headers:{"Content-Type":"application/json","Accept-Encoding":"gzip","X-Api-Key":r,"User-Agent":"PDL-JS-SDK"}}).then(e=>{var t;200===(null==e||null==(t=e.data)?void 0:t.status)&&c(i(e))}).catch(e=>{d(a(e))})}).catch(e=>{d(e)})});class h{constructor({apiKey:h,basePath:l,sandboxBasePath:c,version:d}){this.apiKey=void 0,this.basePath=void 0,this.sandboxBasePath=void 0,this.person=void 0,this.company=void 0,this.school=void 0,this.location=void 0,this.autocomplete=void 0,this.skill=void 0,this.jobTitle=void 0,this.apiKey=h,this.basePath=l||`https://api.peopledatalabs.com/${d||"v5"}`,this.sandboxBasePath=c||`https://sandbox.api.peopledatalabs.com/${d||"v5"}`,this.person={enrichment:e=>r(this.basePath,this.sandboxBasePath,this.apiKey,e,"person"),search:{elastic:e=>o(this.basePath,this.sandboxBasePath,this.apiKey,"elastic",e,"person"),sql:e=>o(this.basePath,this.sandboxBasePath,this.apiKey,"sql",e,"person")},bulk:t=>((t,n,r)=>{const o={"Content-Type":"application/json","Accept-Encoding":"gzip","X-Api-Key":n,"User-Agent":"PDL-JS-SDK"};return new Promise((h,l)=>{s(r,t,n,"Records","bulk").then(()=>{e.post(`${t}/person/bulk`,r,{headers:o}).then(e=>{h(i(e))}).catch(e=>{l(a(e))})}).catch(e=>{l(e)})})})(this.basePath,this.apiKey,t),identify:n=>((n,r,o,h)=>new Promise((l,c)=>{s(h,n,o,null,"identify").then(()=>{const s=h.sandbox?`${r}/person/identify`:`${n}/person/identify`,d=h;delete d.sandbox,Object.entries(d).forEach(([e,t])=>{"object"==typeof t&&(d[e]=JSON.stringify(t))}),e.get(s,{params:t({api_key:o},d),headers:{"Accept-Encoding":"gzip","User-Agent":"PDL-JS-SDK"}}).then(e=>{var t;200===(null==e||null==(t=e.data)?void 0:t.status)&&l(i(e))}).catch(e=>{c(a(e))})}).catch(e=>{c(e)})}))(this.basePath,this.sandboxBasePath,this.apiKey,n),retrieve:n=>((n,r,o)=>new Promise((h,l)=>{s(o,n,r,"ID","retrieve").then(()=>{e.get(`${n}/person/retrieve/${o.id}`,{params:t({api_key:r},o),headers:{"Accept-Encoding":"gzip","User-Agent":"PDL-JS-SDK"}}).then(e=>{var t;200===(null==e||null==(t=e.data)?void 0:t.status)&&h(i(e))}).catch(e=>{l(a(e))})}).catch(e=>{l(e)})}))(this.basePath,this.apiKey,n)},this.company={enrichment:e=>r(this.basePath,this.sandboxBasePath,this.apiKey,e,"company"),search:{elastic:e=>o(this.basePath,this.sandboxBasePath,this.apiKey,"elastic",e,"company"),sql:e=>o(this.basePath,this.sandboxBasePath,this.apiKey,"sql",e,"company")},cleaner:e=>n(this.basePath,this.apiKey,e,"company")},this.school={cleaner:e=>n(this.basePath,this.apiKey,e,"school")},this.location={cleaner:e=>n(this.basePath,this.apiKey,e,"location")},this.autocomplete=n=>((n,r,o)=>new Promise((h,l)=>{s(o,n,r,null,"autocomplete").then(()=>{const{field:s,text:c,size:d,pretty:p}=o;e.get(`${n}/autocomplete`,{params:t({api_key:r},{field:s,text:c||"",size:d||10,pretty:p||!1}),headers:{"Accept-Encoding":"gzip","User-Agent":"PDL-JS-SDK"}}).then(e=>{var t;200===(null==e||null==(t=e.data)?void 0:t.status)&&h(i(e))}).catch(e=>{l(a(e))})}).catch(e=>{l(e)})}))(this.basePath,this.apiKey,n),this.jobTitle=n=>((n,r,o)=>new Promise((h,l)=>{s(o,n,r,null,"jobTitle").then(()=>{const{jobTitle:s,pretty:c}=o;e.get(`${n}/job_title/enrich`,{params:t({api_key:r},{job_title:s,pretty:c||!1}),headers:{"Accept-Encoding":"gzip","User-Agent":"PDL-JS-SDK"}}).then(e=>{var t;200===(null==e||null==(t=e.data)?void 0:t.status)&&h(i(e))}).catch(e=>{l(a(e))})}).catch(e=>{l(e)})}))(this.basePath,this.apiKey,n),this.skill=n=>((n,r,o)=>new Promise((h,l)=>{s(o,n,r,null,"skill").then(()=>{const{skill:s,pretty:c}=o;e.get(`${n}/skill/enrich`,{params:t({api_key:r},{skill:s,pretty:c||!1}),headers:{"Accept-Encoding":"gzip","User-Agent":"PDL-JS-SDK"}}).then(e=>{var t;200===(null==e||null==(t=e.data)?void 0:t.status)&&h(i(e))}).catch(e=>{l(a(e))})}).catch(e=>{l(e)})}))(this.basePath,this.apiKey,n)}}export{h as default};
//# sourceMappingURL=index.modern.js.map
