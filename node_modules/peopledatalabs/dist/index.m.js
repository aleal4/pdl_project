import e from"axios";function t(){return t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},t.apply(this,arguments)}var n=function(e,t,n,i,a){return new Promise(function(s,r){var o={};if(e||(o.message="Missing "+(i||"Params"),o.status=400,r(o)),"search"===a&&(e.searchQuery||(o.message="Missing searchQuery",o.status=400,r(o))),"retrieve"===a&&(e.id||(o.message="Missing id",o.status=400,r(o))),"autocomplete"===a){var c=e.field,u=["company","country","industry","location","major","region","role","school","sub_role","skill","title"];c?-1===u.indexOf(c)&&(o.message="field should be one of: "+u,o.status=400,r(o)):(o.message="Missing field",o.status=400,r(o))}"jobTitle"===a&&(e.jobTitle||(o.message="Missing jobTitle",o.status=400,r(o))),"skill"===a&&(e.skill||(o.message="Missing skill",o.status=400,r(o))),t||(o.message="Missing API Base Path",o.status=400,r(o)),n&&64===n.length||(o.message="Invalid API Key",o.status=401,r(o)),s()})},i=function(e){var t={400:"Request contained either missing or invalid parameters",401:"Request contained a missing or invalid key",402:"Payment Required, You have hit your account maximum (all matches used)",404:"No records were found matching your request",405:"Request method is not allowed on the requested resource",429:"An error occurred due to requests hitting the API too quick",500:"The server encountered an unexpected condition which prevented it from fulfilling the request"};if(e.response){var n=e.response.status,i=n>=500&&n<600?500:n;return{status:i,message:t[i]}}return{status:500,message:t[500]}},a=function(e){var n={rateLimitRemaining:e.headers["x-ratelimit-remaining"]?JSON.parse(e.headers["x-ratelimit-remaining"].replace(/'/g,'"')):void 0,rateLimitReset:e.headers["x-ratelimit-reset"]||void 0,rateLimitLimit:e.headers["x-ratelimit-limit"]?JSON.parse(e.headers["x-ratelimit-limit"].replace(/'/g,'"')):void 0,totalLimitOveragesRemaining:e.headers["x-totallimit-overages-remaining"]?Number(e.headers["x-totallimit-overages-remaining"]):void 0,totalLimitPurchasedRemaining:e.headers["x-totallimit-purchased-remaining"]?Number(e.headers["x-totallimit-purchased-remaining"]):void 0,totalLimitRemaining:e.headers["x-totallimit-remaining"]?Number(e.headers["x-totallimit-remaining"]):void 0,callCreditsType:e.headers["x-call-credits-type"]||void 0,callCreditsSpent:e.headers["x-call-credits-spent"]?Number(e.headers["x-call-credits-spent"]):void 0,lifetimeUsed:e.headers["x-lifetime-used"]?Number(e.headers["x-lifetime-used"]):void 0};return Array.isArray(e.data)?{items:e.data,rateLimit:n}:t({},e.data,{rateLimit:n})},s=function(s,r,o,c){return new Promise(function(u,l){n(o,s,r,null,"cleaner").then(function(){e.get(s+"/"+c+"/clean",{params:t({api_key:r},o),headers:{"Accept-Encoding":"gzip","User-Agent":"PDL-JS-SDK"}}).then(function(e){var t;200===(null==e||null==(t=e.data)?void 0:t.status)&&u(a(e))}).catch(function(e){l(i(e))})}).catch(function(e){l(e)})})},r=function(s,r,o,c,u){return new Promise(function(l,h){n(c,s,o,null,"enrichment").then(function(){var n=c.sandbox&&"person"===u?r+"/"+u+"/enrich":s+"/"+u+"/enrich",d=c;delete d.sandbox,Object.entries(d).forEach(function(e){var t=e[1];"object"==typeof t&&(d[e[0]]=JSON.stringify(t))}),e.get(n,{params:t({api_key:o},d),headers:{"Accept-Encoding":"gzip","User-Agent":"PDL-JS-SDK"}}).then(function(e){var t;200===(null==e||null==(t=e.data)?void 0:t.status)&&l(a(e))}).catch(function(e){h(i(e))})}).catch(function(e){h(e)})})},o=function(t,s,r,o,c,u){return new Promise(function(l,h){n(c,t,r,null,"search").then(function(){var n,d=c.pretty,p=c.sandbox,f=((n={titlecase:c.titlecase||!1,dataset:c.dataset||"all",scroll_token:c.scroll_token||null,size:c.size||10})["sql"===o?"sql":"query"]=c.searchQuery,n.pretty=d||!1,n);e.post(p&&"person"===u?s+"/person/search":t+"/"+u+"/search",f,{headers:{"Content-Type":"application/json","Accept-Encoding":"gzip","X-Api-Key":r,"User-Agent":"PDL-JS-SDK"}}).then(function(e){var t;200===(null==e||null==(t=e.data)?void 0:t.status)&&l(a(e))}).catch(function(e){h(i(e))})}).catch(function(e){h(e)})})},c=function(c){var u=this,l=c.apiKey,h=c.basePath,d=c.sandboxBasePath,p=c.version;this.apiKey=void 0,this.basePath=void 0,this.sandboxBasePath=void 0,this.person=void 0,this.company=void 0,this.school=void 0,this.location=void 0,this.autocomplete=void 0,this.skill=void 0,this.jobTitle=void 0,this.apiKey=l,this.basePath=h||"https://api.peopledatalabs.com/"+(p||"v5"),this.sandboxBasePath=d||"https://sandbox.api.peopledatalabs.com/"+(p||"v5"),this.person={enrichment:function(e){return r(u.basePath,u.sandboxBasePath,u.apiKey,e,"person")},search:{elastic:function(e){return o(u.basePath,u.sandboxBasePath,u.apiKey,"elastic",e,"person")},sql:function(e){return o(u.basePath,u.sandboxBasePath,u.apiKey,"sql",e,"person")}},bulk:function(t){return function(t,s,r){var o={"Content-Type":"application/json","Accept-Encoding":"gzip","X-Api-Key":s,"User-Agent":"PDL-JS-SDK"};return new Promise(function(c,u){n(r,t,s,"Records","bulk").then(function(){e.post(t+"/person/bulk",r,{headers:o}).then(function(e){c(a(e))}).catch(function(e){u(i(e))})}).catch(function(e){u(e)})})}(u.basePath,u.apiKey,t)},identify:function(s){return function(s,r,o,c){return new Promise(function(u,l){n(c,s,o,null,"identify").then(function(){var n=c.sandbox?r+"/person/identify":s+"/person/identify",h=c;delete h.sandbox,Object.entries(h).forEach(function(e){var t=e[1];"object"==typeof t&&(h[e[0]]=JSON.stringify(t))}),e.get(n,{params:t({api_key:o},h),headers:{"Accept-Encoding":"gzip","User-Agent":"PDL-JS-SDK"}}).then(function(e){var t;200===(null==e||null==(t=e.data)?void 0:t.status)&&u(a(e))}).catch(function(e){l(i(e))})}).catch(function(e){l(e)})})}(u.basePath,u.sandboxBasePath,u.apiKey,s)},retrieve:function(s){return function(s,r,o){return new Promise(function(c,u){n(o,s,r,"ID","retrieve").then(function(){e.get(s+"/person/retrieve/"+o.id,{params:t({api_key:r},o),headers:{"Accept-Encoding":"gzip","User-Agent":"PDL-JS-SDK"}}).then(function(e){var t;200===(null==e||null==(t=e.data)?void 0:t.status)&&c(a(e))}).catch(function(e){u(i(e))})}).catch(function(e){u(e)})})}(u.basePath,u.apiKey,s)}},this.company={enrichment:function(e){return r(u.basePath,u.sandboxBasePath,u.apiKey,e,"company")},search:{elastic:function(e){return o(u.basePath,u.sandboxBasePath,u.apiKey,"elastic",e,"company")},sql:function(e){return o(u.basePath,u.sandboxBasePath,u.apiKey,"sql",e,"company")}},cleaner:function(e){return s(u.basePath,u.apiKey,e,"company")}},this.school={cleaner:function(e){return s(u.basePath,u.apiKey,e,"school")}},this.location={cleaner:function(e){return s(u.basePath,u.apiKey,e,"location")}},this.autocomplete=function(s){return function(s,r,o){return new Promise(function(c,u){n(o,s,r,null,"autocomplete").then(function(){e.get(s+"/autocomplete",{params:t({api_key:r},{field:o.field,text:o.text||"",size:o.size||10,pretty:o.pretty||!1}),headers:{"Accept-Encoding":"gzip","User-Agent":"PDL-JS-SDK"}}).then(function(e){var t;200===(null==e||null==(t=e.data)?void 0:t.status)&&c(a(e))}).catch(function(e){u(i(e))})}).catch(function(e){u(e)})})}(u.basePath,u.apiKey,s)},this.jobTitle=function(s){return function(s,r,o){return new Promise(function(c,u){n(o,s,r,null,"jobTitle").then(function(){e.get(s+"/job_title/enrich",{params:t({api_key:r},{job_title:o.jobTitle,pretty:o.pretty||!1}),headers:{"Accept-Encoding":"gzip","User-Agent":"PDL-JS-SDK"}}).then(function(e){var t;200===(null==e||null==(t=e.data)?void 0:t.status)&&c(a(e))}).catch(function(e){u(i(e))})}).catch(function(e){u(e)})})}(u.basePath,u.apiKey,s)},this.skill=function(s){return function(s,r,o){return new Promise(function(c,u){n(o,s,r,null,"skill").then(function(){e.get(s+"/skill/enrich",{params:t({api_key:r},{skill:o.skill,pretty:o.pretty||!1}),headers:{"Accept-Encoding":"gzip","User-Agent":"PDL-JS-SDK"}}).then(function(e){var t;200===(null==e||null==(t=e.data)?void 0:t.status)&&c(a(e))}).catch(function(e){u(i(e))})}).catch(function(e){u(e)})})}(u.basePath,u.apiKey,s)}};export{c as default};
//# sourceMappingURL=index.m.js.map
